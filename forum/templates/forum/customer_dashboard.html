{% extends "forum/base.html" %}
{% load cloudinary_filters %}

{% block sidebar_links %}
<a href="{% url 'customer_dashboard' %}" class="sidebar-link active">ğŸ  Dashboard</a>
<a href="{% url 'profile' %}" class="sidebar-link">ğŸ‘¤ Profile</a>
<a href="{% url 'contact_admin' %}" class="sidebar-link">âœ‰ï¸ Contact Admin</a>
<a href="{% url 'logout' %}" class="sidebar-link">ğŸšª Logout</a>
{% endblock %}

{% block content %}
<h1 class="page-title">Welcome, {{ user.username }}</h1>

<div class="cards-container">
    {% for post in uploads %}
    <div class="card">

        {% if post.image %}
        <img src="{{ post.image.url|cloudinary_resize }}" 
             alt="{{ post.title }}" class="card-img">
        {% endif %}

        {% if post.video %}
        <video controls class="card-video">
            <source src="{{ post.video.url|cloudinary_resize }}" type="video/mp4">
        </video>
        {% endif %}

        <div class="card-icon">ğŸ“</div>
        <h3>{{ post.title }}</h3>
        <p>{{ post.description|truncatechars:120 }}</p>

        <div class="card-meta">
            {% if post.category %}
            <span class="meta-item">ğŸ“‚ {{ post.category.name }}</span>
            {% endif %}
            <span class="meta-item">ğŸ‘¤ {{ post.user.username }}</span>
            <span class="meta-item">ğŸ•’ {{ post.created_at|date:"M d, Y" }}</span>
        </div>

        {% if post.link %}
        <p class="external-link">ğŸ”— <a href="{{ post.link }}" target="_blank">{{ post.link|truncatechars:30 }}</a></p>
        {% endif %}

        <a href="{% url 'forum_detail' post.id %}" class="btn btn-green"
           style="margin-top:10px; display:block; text-align:center;">ğŸ” View Details</a>

    </div>
    {% empty %}
    <p style="text-align:center;">No posts yet. ğŸ“­</p>
    {% endfor %}
</div>
{% endblock %}
