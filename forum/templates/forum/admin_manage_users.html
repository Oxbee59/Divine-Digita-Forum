{% extends "forum/base.html" %}

{% block sidebar_links %}
<a href="{% url 'admin_dashboard' %}" class="sidebar-link">ğŸ  Dashboard</a>
<a href="{% url 'manage_users' %}" class="sidebar-link active">ğŸ‘¥ Manage Users</a>
<a href="{% url 'manage_posts' %}" class="sidebar-link">ğŸ“ Manage Posts</a>
<a href="{% url 'admin_messages' %}" class="sidebar-link">âœ‰ï¸ Customer Messages</a>
<a href="{% url 'logout' %}" class="sidebar-link">ğŸšª Logout</a>
{% endblock %}

{% block content %}
<h1 class="page-title">Manage Users</h1>

<table class="table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Staff</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
        <tr>
            <td>{{ user.id }}</td>
            <td>{{ user.username }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.last_name }}</td> <!-- PHONE DISPLAYED HERE -->
            <td>{% if user.is_staff %}âœ…{% else %}âŒ{% endif %}</td>

            <td>
                <!-- Inline Edit Form -->
                <form method="POST" action="{% url 'edit_user' user.id %}" style="display:inline-block;">
                    {% csrf_token %}
                    <input type="text" name="username" value="{{ user.username }}" required>
                    <input type="email" name="email" value="{{ user.email }}" required>
                    <input type="number" name="phone" value="{{ user.last_name }}" required placeholder="Phone">

                    <label>
                        <input type="checkbox" name="is_staff" {% if user.is_staff %}checked{% endif %}>
                        Staff
                    </label>

                    <button type="submit" class="btn btn-edit">âœï¸ Update</button>
                </form>

                <!-- Delete Button -->
                <form method="POST" action="{% url 'delete_user' user.id %}" style="display:inline-block;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-delete">ğŸ—‘ï¸ Delete</button>
                </form>
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="6" style="text-align:center;">No users found.</td></tr>
        {% endfor %}
    </tbody>
</table>

<style>
.table { width:100%; border-collapse: collapse; margin-top: 20px;}
.table th, .table td { border:1px solid #ddd; padding:10px; text-align:left; vertical-align:middle; }
.table th { background:#0b7d36; color:white; }
.btn-edit { padding:5px 8px; border-radius:6px; color:white; background:#0b7d36; border:none; cursor:pointer; margin-right:5px; }
.btn-delete { padding:5px 8px; border-radius:6px; color:white; background:#c0392b; border:none; cursor:pointer; }
.btn-edit:hover, .btn-delete:hover { opacity:0.9; }
input[type="text"], input[type="email"], input[type="number"] { padding:4px 6px; border-radius:4px; border:1px solid #ccc; margin-right:4px; width:130px; }
</style>

{% endblock %}
