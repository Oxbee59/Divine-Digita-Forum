{% extends "forum/base.html" %}

{% block sidebar_links %}
<a href="{% url 'admin_dashboard' %}" class="sidebar-link">ğŸ  Dashboard</a>
<a href="{% url 'manage_users' %}" class="sidebar-link">ğŸ‘¥ Manage Users</a>
<a href="{% url 'manage_posts' %}" class="sidebar-link">ğŸ“ Manage Posts</a>
<a href="{% url 'admin_uploads' %}" class="sidebar-link active">ğŸ“‚ Uploads</a>
<a href="{% url 'admin_messages' %}" class="sidebar-link">âœ‰ï¸ Customer Messages</a>
<a href="{% url 'logout' %}" class="sidebar-link">ğŸšª Logout</a>
{% endblock %}

{% block content %}
<h1 class="page-title">Uploads Management</h1>

<!-- Add Upload Form -->
<div class="card upload-form-card">
    <h3>â• Add New Upload</h3>
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <label>Title</label>
        <input type="text" name="title" required>

        <label>Description</label>
        <textarea name="description" rows="3" required></textarea>

        <label>Category</label>
        <select name="category">
            <option value="">--Select Category--</option>
            {% for cat in categories %}
            <option value="{{ cat.id }}">{{ cat.name }}</option>
            {% endfor %}
        </select>

        <label>Video (optional)</label>
        <input type="file" name="video" accept="video/*">

        <label>Image (optional)</label>
        <input type="file" name="image" accept="image/*">

        <label>External Link (optional)</label>
        <input type="url" name="link" placeholder="https://example.com">

        <button type="submit">Upload</button>
    </form>
</div>

<!-- Uploaded Items -->
<div class="cards-container" style="margin-top:30px;">
    {% for upload in uploads %}
    <div class="card">
        <h3>ğŸ“Œ {{ upload.title }}</h3>
        <p>{{ upload.description }}</p>
        {% if upload.category %}
        <p><strong>Category:</strong> {{ upload.category.name }}</p>
        {% endif %}
        {% if upload.video %}
        <video width="100%" controls>
            <source src="{{ upload.video.url }}" type="video/mp4">
        </video>
        {% endif %}
        {% if upload.image %}
        <img src="{{ upload.image.url }}" alt="{{ upload.title }}" class="card-img">
        {% endif %}
        {% if upload.link %}
        <p>ğŸ”— <a href="{{ upload.link }}" target="_blank">{{ upload.link }}</a></p>
        {% endif %}
        <p><strong>Uploaded by:</strong> {{ upload.user.username }}</p>
    </div>
    {% empty %}
    <p>No uploads yet.</p>
    {% endfor %}
</div>

<style>
.upload-form-card { background:#f0fff4; padding:20px; border-radius:12px; box-shadow:0 4px 6px rgba(0,0,0,0.1); margin-bottom:20px;}
.upload-form-card h3 { color:#0b7d36; margin-bottom:15px; }
.upload-form-card input, .upload-form-card textarea, .upload-form-card select, .upload-form-card button {
    width:100%; padding:8px 10px; margin-bottom:15px; border-radius:5px; border:1px solid #ccc;
}
.upload-form-card button {
    background:#0b7d36; color:white; border:none; cursor:pointer;
}
.upload-form-card button:hover { background:#0d8e3d; }
.card-img { width:100%; border-radius:6px; margin-top:10px; }
.cards-container { display:flex; flex-wrap:wrap; gap:20px; justify-content:center; }
.card { flex:1 1 300px; background:#f0fff4; padding:20px; border-radius:12px; box-shadow:0 4px 6px rgba(0,0,0,0.1); }
.card h3 { color:#0b7d36; margin-bottom:10px; }
</style>
{% endblock %}
