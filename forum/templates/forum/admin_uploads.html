{% extends "forum/base.html" %}

{% block sidebar_links %}
<a href="{% url 'admin_dashboard' %}" class="sidebar-link">ğŸ  Dashboard</a>
<a href="{% url 'manage_users' %}" class="sidebar-link">ğŸ‘¥ Manage Users</a>
<a href="{% url 'manage_posts' %}" class="sidebar-link">ğŸ“ Manage Posts</a>
<a href="{% url 'admin_uploads' %}" class="sidebar-link active">ğŸ“‚ Uploads</a>
<a href="{% url 'admin_messages' %}" class="sidebar-link">âœ‰ï¸ Customer Messages</a>
<a href="{% url 'logout' %}" class="sidebar-link">ğŸšª Logout</a>
{% endblock %}

{% block content %}
<h1 class="page-title">Uploads Management</h1>

<div class="card">
    <h3>â• Add New Upload</h3>
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <label>Title</label>
        <input type="text" name="title" required>

        <label>Description</label>
        <textarea name="description" rows="3" required></textarea>

        <label>Category</label>
        <select name="category">
            <option value="">--Select Category--</option>
            {% for cat in categories %}
            <option value="{{ cat.id }}">{{ cat.name }}</option>
            {% endfor %}
        </select>

        <label>Video (optional)</label>
        <input type="file" name="video" accept="video/*">

        <label>Image (optional)</label>
        <input type="file" name="image" accept="image/*">

        <label>External Link (optional)</label>
        <input type="url" name="link">

        <button type="submit" class="btn btn-green" style="margin-top:10px;">Upload</button>
    </form>
</div>

<div class="cards-container" style="margin-top:20px;">
    {% for upload in uploads %}
    <div class="card">
        <h3>ğŸ“Œ {{ upload.title }}</h3>
        <p>{{ upload.description }}</p>

        {% if upload.category %}
        <p><strong>Category:</strong> {{ upload.category.name }}</p>
        {% endif %}

        {% if upload.video %}
        <video controls class="card-video">
            <source src="{{ upload.video.url|replace:'upload/','upload/w_900,h_500,c_fill,f_auto,q_auto/' }}" type="video/mp4">
        </video>
        {% endif %}

        {% if upload.image %}
        <img src="{{ upload.image.url|replace:'upload/','upload/w_900,h_500,c_fill,f_auto,q_auto/' }}" class="card-img">
        {% endif %}

        {% if upload.link %}
        <p>ğŸ”— <a href="{{ upload.link }}" target="_blank">{{ upload.link }}</a></p>
        {% endif %}

        <p><strong>Uploaded by:</strong> {{ upload.user.username }}</p>
    </div>
    {% empty %}
    <p style="text-align:center;">No uploads yet.</p>
    {% endfor %}
</div>

{% endblock %}
